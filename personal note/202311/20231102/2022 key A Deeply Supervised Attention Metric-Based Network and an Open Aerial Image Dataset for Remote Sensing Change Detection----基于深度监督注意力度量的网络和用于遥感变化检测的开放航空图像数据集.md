
![[Shi 等 - 2022 - A Deeply Supervised Attention Metric-Based Network.pdf]]


本文针对遥感变化检测的问题，提出了一种深度监督的注意力度量网络（DSAMNet）。DSAMNet首先通过Siamese特征提取器从双时相图像的不同层次中提取多尺度特征，然后利用卷积块注意力模块（CBAM）使得不同阶段的特征在通道和空间上都更具区分性。接着，度量模块从成对双时相特征图在低维嵌入空间中的距离学习出变化地图。此外，引入了一个深度监督（DS）模块来增强特征提取器的学习能力，学习更有效的信息。为了减少深度学习模型对大量样本的依赖和满足不同场景下的变化检测需求，我们构建了一个新的、大规模的、开源的变化检测数据集（CDD）——中山大学（SYSU）-CD。SYSU-CD数据集不仅提供了城市和郊区的常见变化信息，还增补了高密度建筑变化和海上建设的标注。

 本文提出的 DSAMNet 在广泛使用的 CDD 基准数据集和新提出的 SYSU-CD 数据集上取得了最先进的性能，F1 分别达到了 93.69% 和 78.18%。文章结构如下：II节回顾相关工作，III节详细描述 SYSU-CD 数据集，IV节介绍提出的网络，V节展示所有实验的设定和结果，VI节讨论 DSAMNet 中损失的敏感性和提出数据集的必要性，VII节总结文章。

传统的 CD 方法利用简单代数来获取差异图像作为特征，如图像比例，图像差异和图像回归。由于这些基于代数的方法严重依赖阈值选择以确定变化像素和未变化像素，因此引入了一些转换技术到 CD 中。然而，这些方法仍然难以满足大规模、细粒度 CD 的需求。近年来，由于其强大的特征提取能力，新开发的基于深度学习的 CD 方法取得了优异的结果。然而，这些方法的应用可能导致非常低的计算效率和非常高的内存消耗。为了解决这些问题，提出了完全卷积网络（FCN）来通过将 CNN 的全连接层替换为全卷积层来实现像素级预测。然而，这些方法的改进是有限的。

因此，我们提出的方法将 CBAM 引入网络，这种方法通过通道和空间方式学习更具区分性的特征以减轻伪变化的影响。此外，还整合了 DS 模块来指导特征提取器的学习并补充更多有用的信息以生成变化图。

在过去的几十年里，我们见证了开放 CDD 的发展。我们收集了这些数据集的图像对数、大小、分辨率和带宽数用于我们的提议数据集。尽管这些数据集已经解决了检测多时相遥感图像间变化的问题，但仍有一些改进可以实现大规模和细粒度 CD。SYSU-CD 数据集在图像分辨率、变化类型和数据集体积方面大大补充了现有的 CD 数据集，并进一步提供了 CD 的新基准。此数据集包含了20000对 0.5 米的航空图像，拍摄于2007年至2014年间的香港。根据6:2:2的比例，我们首先将原始的800对图像分为训练集、验证集和测试集。然后，为了生成 DL 应用的数据集，从每对图像中随机收集25对 256×256 大小的样本对，其中应用随机翻转和旋转进行数据增强。SYSU-CD 数据集将对所有研究需求公开提供。

在本节中，首先提供了我们提出的网络的概述，然后详细描述了每个网络模块，最后介绍了模型优化策略。提出的网络由三部分组成：特征提取器、度量模块和 DS 模块。特征提取器自动从双时相输入中提取多尺度特征以进行 CD，然后度量模块根据双时相特征对学习距离图，在此之前，CBAM 块被用来使特征从通道和空间角度更具区分性。此外，深度监督与 DS 模块一起用于监督训练过程。


让 IT 1 和 IT 2 代表在不同时间点 T 1 和 T 2 的相同区域的一对图像，而 y 代表带有变化注释的标签。DSAMNet 的流程图可以总结如下：1) 首先，将图像 IT1 和 IT 2 输入到权重共享的特征提取器中，每个获得一组多尺度特征向量 Fm，m = T1，T 2。2) 接下来，将同一时刻的向量全部合并为一个，从而得到与 FeatT1 和 FeatT 2 的同一维度的特征对，然后应用 CBAM 块使其更具区别性。度量模块计算 FeatT1 和 FeatT2 之间的距离图 D，然后根据距离图 D 和标签 y 计算批量对比损失（BCL） LBCL。

3) 同时，将两个特征的绝对值 Fabs = {feati T 1 - feati T 2}，i = 1, 2 输入到 DS 层，产生两个中间变化图 Cmap1, Cmap2，然后根据 Cmap1, Cmap2 和标签 y 计算骰子损失 LDice。4) 最后，将 LBCL 和 LDice 相加以便进行更准确的模型训练。特征提取器采用 Siamese 架构，两个权重共享的分支来从双时序图像对中提取特征。

度量模块通过比较双时序图像的嵌入特征向量来学习变化图。因此，比较的双时序特征对的构造对结果至关重要。为了最大限度地利用低级特征中的足够空间信息和高级特征中的丰富语义信息，利用多尺度特征融合策略来重构特征提取器的每个分支的多级特征获得的配对特征。最后，以欧几里得距离地图计算基于精细特征对的距离。

DS 模块主要引入深度监督网络（DSN）来提供隐藏层的直接监督，目标是帮助隐藏层的学习，并获得更强大和更具区分性的特征。

 这一部分详细介绍了 DSAMNet 的设计及优化过程。首先，为了进行监督，将 DS 网络整合到特征提取器的隐藏层中，只有两个 DS 层被添加到特征提取器的第二层和第三层特征上。每个 DS 层包含两个 3 × 3 的反卷积层以将特征图升采样至输入图像的大小，并通过 sigmoid 层获得每个像素类别的概率分布。此外，特征之间的绝对差值被送入 DS 层以筛选更有效的变化信息。

然后，介绍了用于优化 CD 网络的目标函数。在度量模块中，使用对比损失来衡量距离图和实际值之间的相似度。另一方面，为解决 CD 类别不平衡的问题，监督模块中采用了骰子损失，通过骰子系数衡量预测图和实际值之间的相似度。

最后，网络的目标函数被定义为对比损失和骰子损失的和，其中 λ 是用于调节 DS 模块影响的因子。并给出了 DSAMNet 的优化流程。

这部分主要探讨了几种基于U-Net和度量学习的变化检测(CD)方法，并且比较了它们的性能。具体包括：FC-Siam-conc和FC-Siam-diff两种基于孪生网络编码器的方法，BiDateNet引入了LSTM块以捕获时间变化模式，以及STANet这种基于度量学习的方法，利用空间时间注意力模块提取特征。实验比较了上采样和度量学习这两种获取变化图的方法，并测试了不同注意力机制的效果。实验使用PyTorch库，并尽可能地保持参数设置与原文献一致。评估性能时，使用了精确度、召回率、F1分数和IoU这四个指标。DSAMNet通过整合CBAM和DS模块，在CDD和SYSU-CD数据集上都取得了最优性能。还进行了消融实验，验证了CBAM块和DS层的有效性，证实了它们组合使用时的增益效果。最后，对混合损失函数的参数设置进行了敏感性分析。

本节分两部分：一是对混合损失函数的灵敏度实验，二是对SYSU-CD数据集的讨论。混合损失函数结合了对比损失和骰子损失，对模型的训练和最终性能有重要影响。实验结果表明，λ值的设定对模型的准确性有显著影响。在CDD数据集上，当λ=0.1时，模型达到最高的F1和IoU。在SYSU-CD数据集上，当λ=0.3时，模型取得最高的F1和IoU。然后，随着λ的增加，模型的准确性只有微小的提高或甚至有所下降。

在讨论SYSU-CD数据集时，尽管**该数据集的场景复杂，变化类型多样**，但DSAMNet在该数据集上也取得了相对良好的变化检测结果。然而，DSAMNet在SYSU-CD上的最佳F1性能比在CDD数据集上低约15.51%。**主要原因是SYSU-CD数据集包含很多高层建筑和密集的建筑，这在许多现有的数据集中是不足的，使得变化检测的准确性在一定程度上受到复杂环境的限制**。此外，SYSU-CD数据集包含更多复杂和混淆的变化类型，这也导致了SYSU-CD的检测率相对较低。尽管如此，我们仍然在SYSU-CD数据集上取得了相对良好的变化检测结果，并指出在这样复杂的场景下检测变化的紧迫需要。


1. Title: "A Deeply Supervised Attention Metric-Based Network and an Open Aerial Image Dataset for Remote Sensing Change Detection"（深度监督的注意力度量网络及开放的航空图像数据集用于遥感变化检测）

2. Authors: Qian Shi, Mengxi Liu, Shengchen Li, Xiaoping Liu, Fei Wang, and Liangpei Zhang

3. Affiliation: 南方科技大学

4. Keywords: Change Detection, Deep Learning, Deeply Supervised, Attention Metric-Based Network, Aerial Image Dataset

5. Urls: Paper:None, Github:None

6. Summary:

    - (1):本文的研究背景是遥感变化检测，特别是如何通过深度学习方法来提高变化检测的准确性和鲁棒性。

    - (2):以往的方法主要基于简单的代数运算，如图像比例、图像差异和图像回归。这些方法对阈值选择的依赖程度高，易受光照、噪声和尺度的影响，导致伪变化和噪声影响检测结果。有鉴于此，本文的研究方法有充分的动机。

    - (3):本文提出了一种深度监督的注意力度量网络（DSAMNet）。DSAMNet使用度量模块进行深度度量学习，并集成了卷积块注意力模块（CBAM）以提供更具区分性的特征。同时，引入了深度监督模块以增强学习能力。

    - (4):本文的方法在CDD基准数据集和SYSU-CD数据集上进行了测试，F1分数分别达到了93.69%和78.18%，这证明了本文方法的有效性，能够达到其提高遥感变化检测准确性的目标。


CDD
![[Pasted image 20231102170910.png]]
 
|Model name|Precision|Recall|F1 score|IoU|
|---|---|---|---|---|
|FC-Siam-conc|92.15|80.44|85.90|75.28|
|FC-Siam-diff|94.76|73.71|82.93|70.84|
|STANet|89.28|93.71|91.44|84.23|
|DSAMNet|94.54|92.77|93.69|88.13|


SYSU-CD
![[Pasted image 20231102170902.png]]

 
|Model name|Precision|Recall|F1 score|IoU|
|---|---|---|---|---|
|FC-Siam-conc|82.54|71.03|76.35|61.75|
|FC-Siam-diff|89.13|61.21|72.57|56.96|
|STANet|70.76|85.33|77.37|63.09|
|DSAMNet|74.81|81.86|78.18|64.18|