首先导入我们需要使用的工具库
```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import torch
import torch.optim as optim
import warnings
warnings.filterwarnings("ignore")
%matplotlib inline
```
```python
features = pd.read_csv('temps.csv')

# 先看数据是什么样子的
features.head()
```
![[Pasted image 20230506190303.png]]
数据表中
- year month day week分别表示的具体的事件
- temp_2 前天的最高气温
- temp_1 昨天的最高气温
- average 历史中每年这一天的平均最高温度
- actual 标签值，当天的真实最高问题
- friend 没有什么含义

```python
print('数据维度:', features.shape)
```
![[Pasted image 20230506190548.png]]
代表有348天数据，有9个feature

```python
import datetime
# 处理时间数据

years = features['year']
months = features['month']
days = features['day']
# 分别得到年，月，日

# datetime格式
dates = [str(int(year)) + '-' + str(int(month)) + '-' + str(int(day)) for year, month,day in zip(years, months, days)]
dates = [datetime.datetime.strptime(date, '%Y-%m-%d') for date in dates]
```
是为了可视化方便

```python
dates[:5]
```
![[Pasted image 20230506191111.png]]

```python
# 准备画图
# 指定默认风格
plt.style.use('fivethirtyeight')

# 设置布局
fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(nrows=2, ncols=2, figsize = (10,10))
fig.autofmt_xdate(rotation = 45)

# 标签值
axl.plot(dates, features['actual'])
axl.set_xlabel(''); ax1.set_ylabel('Temperature'); ax1.set_title('Max Temp')

# 昨天
ax2.plot(dates, features['temp_1'])
ax2.set_xlabel(''); ax2.set_ylabel('Temperature'); ax2.set_title('Previous Max Temp')

# 前天
ax3.plot(dates, features['temp_2'])
ax3.set_xlabel('Date'); ax2.set_ylabel('Temperature'); ax2.set_title('Two Days Prior Max Temp')

# friend
ax4.plot(dates, features['friend'])
ax3.set_xlabel('Date'); ax2.set_ylabel('Temperature'); ax2.set_title('Friend Estimate')

plt.tight_layout(pad=2)
```
![[Pasted image 20230506191814.png]]
![[Pasted image 20230506191854.png]]

需要把week变为独热编码，从字符串转换成数字
```python
features = pd.get_dummies(features)
features.head(5)
```
![[Pasted image 20230506191958.png]]

```python
# 标签
labels = np.array(features['actual'])

# 在特征中去掉标签
features = features.drop('actual', axis = 1)

# 名字单独保存，避免丢失
feature_list = list(features.columns)

# 转换成合适的形式
features = np.array(features)
```
```python
features.shape
```
![[Pasted image 20230506192249.png]]

需要进行数据标准化
```python
from sklearn import preprocessing
input_features = preprocessing.StandardScaler().fit_transform(features)
```