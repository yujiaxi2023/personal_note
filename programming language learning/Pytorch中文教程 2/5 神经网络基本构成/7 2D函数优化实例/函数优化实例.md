![[Pasted image 20230526195206.png]]
现在有一个2D的函数，包含有其函数图像
这个函数是计算机科学家用来找到优化器是否可以良好的表现的一种函数
这里的函数最小值是一样的结果
![[Pasted image 20230526195352.png]]
对于这个函数可以测试神经网络是否可以收敛到最小值的解

首先实现这个函数 然后进行可视化
```python
def himmelblau(x):  
    return (x[0] ** 2 + x[1] - 11) ** 2 + (x[0] + x[1] ** 2 - 7) ** 2  

x = np.arange(-6, 6, 0.1)  
y = np.arange(-6, 6, 0.1)  
print('x,y range:', x.shape, y.shape)  
X, Y = np.meshgrid(x, y)  
print('X, Y maps:', X.shape, Y.shape)  
Z = himmelblau([X, Y])  
  
fig = plt.figure('himmelblau')  
ax = fig.add_subplot(111, projection='3d')  
ax.plot_surface(X, Y, Z)  
ax.view_init(60, -30)  
ax.set_xlabel('x')  
ax.set_ylabel('y')  
plt.show()
```
然后进行梯度下降，这里梯度下降是使用pred值对x值求偏微分再反向传播
```python
x = torch.tensor([0., 0.], requires_grad=True)  
optimizer = torch.optim.Adam([x], lr=1e-3)  
for step in range(20000):  
  
   pred = himmelblau(x)  
  
   optimizer.zero_grad()  
   pred.backward()  
   optimizer.step()  
  
   if step % 2000 == 0:  
      print(f'step {step}: x = {x.tolist()}, f(x) = {pred.item()}')
```
初始化x张量为0，0的时候找到的全局最小值是3，2
![[Pasted image 20230526202100.png]]
如果修改初始化值为别的可以出现变化
![[Pasted image 20230526202151.png]]
所以找到了另一个初始化值