![[Pasted image 20230328193131.png]]
当对图像进行两层3x3的卷积
这个第二层的神经元可以看到整个5x5区域的信息
这就表明了我们可以用两层3x3卷积代替一个5x5的卷积
![[Pasted image 20230328193535.png]]
同理我们使用3个3x3的卷积就可以表示7x7的卷积，感受野
以上的示例是我们利用小卷积核来代替大的卷积核
那么这样做有什么好处呢
![[Pasted image 20230328194109.png]]
首先如果原来的卷积核是7x7的卷积核，那如果有c个通道也就是特征量，那就是49c，然后要有与通道数匹配的卷积核的数量那就是49c²
如果采用3个3x3的卷积核，那结果就是3x3xCxCx3，前面类似后边是3个小的代替大的
初始条件如上图
因此我们可以知道同样大的感受野，会有更少的参数量和计算量，而且会有更深的网络也就是更深的非线性变换
![[Pasted image 20230328194412.png]]
![[Pasted image 20230328194434.png]]
上面的公式可以看出，当卷积核更大的时候，所需要的计算量因为每个卷积核比较大，所以叠加次数相同的情况下，会远远增大，而如果用3个小的卷积核代替，则会减少其中的计算量
![[Pasted image 20230328194726.png]]
结果就是如上图公式结果
![[Pasted image 20230328194857.png]]
在该文章中介绍了先降维再升维的解决方式
![[Pasted image 20230328194941.png]]
在这里 我们先用了1x1的卷积核先降维，把通道减少一半，然后用3x3的卷积核，然后再用1x1的去升维回去
这里我们把3x3的卷积核这一步骤变为了3步
这样这个模型的能力变得更强了
![[Pasted image 20230328195250.png]]
还有一种方法是先变成1x3的卷积核然后再进行一次3x1的卷积核，最终还是3x3的效果，但是实际上有更深的网络和更少的计算
![[Pasted image 20230328195348.png]]
这个变化现在有更加深入的解决方式
inception的version已经更新了很多了，需要查找现在最新的inception
![[Pasted image 20230328195621.png]]
![[Pasted image 20230328195834.png]]
**如何高效计算卷积**
![[Pasted image 20230328201239.png]]
我们把卷积运算变成矩阵乘法
im2col这种操作的名称
![[Pasted image 20230328201354.png]]
首先把感受野拉成一列矩阵
![[Pasted image 20230328201422.png]]
但是这种方式会出现一种缺点就是，感受野之间是存在重叠部分，里面有很多的元素会重复占用大量的内存
![[Pasted image 20230328201517.png]]
然后把卷积核拉成一行矩阵
这里也说明了卷积核的数量需要对应于原始通道的数量
![[Pasted image 20230328201631.png]]
![[Pasted image 20230328201823.png]]
但是为了让矩阵可以相乘，所以需要调换位置
![[Pasted image 20230328201903.png]]
![[Pasted image 20230328201920.png]]
上面的图就表现了如何从感受野变为列向量
![[Pasted image 20230328201954.png]]
如果是三通道的图像就变成上图的列向量和行向量卷积核
![[Pasted image 20230328202101.png]]
然后进行矩阵运算
![[Pasted image 20230328202127.png]]
有三个输出的样式
![[Pasted image 20230328202226.png]]
![[Pasted image 20230328202354.png]]
直接的卷积是采用for循环进行计算，但是太慢，所以需要转换为矩阵计算
![[Pasted image 20230328202421.png]]
![[Pasted image 20230328202543.png]]
整体流程就是输入image batch 的感受野经过im2col过程变成行向量点乘卷积核reshape的列向量，最后得出的矩阵reshape回原来的样子
![[Pasted image 20230328202704.png]]
这篇论文说明了im2col的过程
![[Pasted image 20230328202809.png]]
还可以使用快速傅里叶变换FFT的方式进行卷积计算
流程如下
![[Pasted image 20230328202900.png]]
可以加速大卷积核，如果对于3x3的小卷积核没有什么优势
当卷积步长＞1的时候可能丢弃掉部分的结果
![[Pasted image 20230328203015.png]]
![[Pasted image 20230328203023.png]]
傅里叶变换的本质如上图，把任何信号变为不同频率和不同幅度的正弦信号的叠加，然后可以把时域信号变为频域信号
其中黑线表示原始的时域信号，五彩的线白哦显得是频域信号
![[Pasted image 20230328203222.png]]
![[Pasted image 20230328203232.png]]
![[Pasted image 20230328203435.png]]
图示是利用低通滤波器作用于原始的时域信号剩余的信号
卷积核本质上是二维信号上的滤波器
![[Pasted image 20230328203659.png]]
![[Pasted image 20230328203706.png]]
低通滤波器实际上是平滑和模糊作用，高通滤波器是提取明暗变化剧烈的区域
![[Pasted image 20230328203809.png]]
![[Pasted image 20230328203818.png]]
因此数学上就可以用这种变化来快速计算
![[Pasted image 20230328203911.png]]
![[Pasted image 20230328204310.png]]
![[Pasted image 20230328204328.png]]
上面两张图是采用strassen算法相比于原始矩阵计算带来的好处，因为 strassen算法可以再指数上减少0.2左右的计算量

![[Pasted image 20230328203955.png]]
这种是专门计算3x3的卷积
![[Pasted image 20230328204100.png]]
因而我们现在有三种方式可以加速卷积的乘法，第一步是变换为矩阵，第二部是用傅里叶变换的思想去进行快速傅里叶变换进行计算，第三种是用网上现存的各种加速矩阵算法进行计算，后面两种方式是适用于不同的情况下的，例如FFT就适合于大卷积计算
