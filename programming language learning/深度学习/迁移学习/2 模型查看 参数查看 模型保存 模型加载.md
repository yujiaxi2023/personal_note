 - net.modules() net.named_modules()
 - net.children() net.named_children()
 - net.parameters() net.named_parameters()
 - net.state_dict()
前两行查看网络
后两行查看网络参数

```python
import torch  
  
class MyModel(torch.nn.Module):  
    def __init__(self):  
        super().__init__()  
        self.layer1 = torch.nn.Sequential(  
            torch.nn.Linear(3,4),  
            torch.nn.Linear(4,3),  
        )  
  
        self.layer2 = torch.nn.Linear(3, 6)  
  
        self.layer3 = torch.nn.Sequential(  
            torch.nn.Linear(6, 7),  
            torch.nn.Linear(7, 5),  
        )  
  
    def forward(self, x):  
        x = self.layer1(x)  
        x = self.layer2(x)  
        x = self.layer3(x)  
        return x  
  
net = MyModel()  
print(net)  
  
  
# MyModel(  
#   (layer1): Sequential(  
#     (0): Linear(in_features=3, out_features=4, bias=True)  
#     (1): Linear(in_features=4, out_features=3, bias=True)  
#   )  
#   (layer2): Linear(in_features=3, out_features=6, bias=True)  
#   (layer3): Sequential(  
#     (0): Linear(in_features=6, out_features=7, bias=True)  
#     (1): Linear(in_features=7, out_features=5, bias=True)  
#   )  
# )  
  
for layer in net.modules():  
    print(layer) # 递归打印所有层  
    # print(type(layer))  
  
  
for name, layer in net.named_modules():  
    print(name, layer) # 递归打印所有层 并且显示名字  
    # print(name, type(layer))  
  
for layer in net.children():  
    print(layer) # 这就只会打印第一层级  
  
for name, layer in net.named_children():  
    print(name, layer) # 获得层级的名字  
  
for param in net.parameters():  
    print(param.shape) # 打印每一层的shape  
  
for name, param in net.named_parameters():  
    print(name, param.shape) # 因为参数包含有weight和bias,所以看着多  
  
for key,value in net.state_dict().items():  
    print(key,value.shape) # 参数名和层级,以及参数
```


![[Pasted image 20231101162936.png]]

旧版本的pretrained=True就没有选择
所以现在可以选择不同版本的预训练模型
https://pytorch.org/vision/stable/models.html

如何获得官网上的pth文件呢?
```python
import torchvision.models as models  
import torch
```

```python
alexnet = models.alexnet(weights=None)  
  
resnet50 = models.resnet50(weights=models.ResNet50_Weights.DEFAULT)  
  
print(alexnet)  
print(resnet50)
```

如何保存模型
```python
# ----------------------------------------  
# 如何保存模型?  
# ----------------------------------------
resnet50 = models.resnet50(weights=models.ResNet50_Weights.DEFAULT)  
  
# 1. 仅仅保存模型的参数  
torch.save(resnet50.state_dict(),'resnet50_weight.pth')  
  
# 2. 保存模型和参数  
torch.save(resnet50, 'resnet50.pth')
```

如何加载模型
```python
# ----------------------------------------  
# 如何加载模型?  
# ----------------------------------------  
  
# 1. 加载模型+参数  
net = torch.load("resnet50.pth")  
print(net)  
  
# 2. 已有模型,加载预训练参数  
resnet50 = models.resnet50(weights=None)  
  
resnet50.load_state_dict(torch.load('resnet50_weight.pth'))
```

