溯源的时候是使用的最多的

就是我们阅读日志文件中定位到攻击的对象

```
cd /var/log/ # 查看我们的日志目录
cat /var/log/secure # 查看登录
```
![[Pasted image 20231217230243.png]]
如果密码输入错误
![[Pasted image 20231217230301.png]]
![[Pasted image 20231217230319.png]]
这里就记录了登录错误的日志文件
### grep

```
grep "Failed" secure
```
就会在secure中查找到有多少次登录失败的记录
如果我的ip地址是我们自己的，会看到使用了各种用户名来查找
因为我们自己的虚拟机，所以搜索可能比较干净
但是如果是存在的服务器，那攻击就会很多了
人家可能会拿字典来暴力破解你的服务器
![[Pasted image 20231217230740.png]]

因为我们服务器遭受的攻击是非常多的，所以如果一个个的查某一个ip出现多少次非常不效率
所以我们可以引入正则表达式

##### 正则表达式
正则表达式是借助三剑客来使用

```
grep "Failed password" secure | grep --color -P "正则表达式"
```

![[Pasted image 20231217231130.png]]

它会自动标红IP地址，并显示出来

我只要ip地址
```
grep "Failed password" secure | grep --color -Po "正则表达式"
```

接下来我想要排序
```
grep "Failed password" secure | grep --color -Po "正则表达式" | sort -n
```
这样就可以按照ip地址的大小排序

![[Pasted image 20231217231318.png]]

接下来去重计数
```
grep "Failed password" secure | grep --color -Po "正则表达式" | sort -n | uniq -c
```
![[Pasted image 20231217231353.png]]
会看到ip地址，这就是有一个存在在德国的网段会大量进行攻击
我们可以做的就是将网段拉黑

登录云平台
![[Pasted image 20231217231531.png]]
就可以看到安全组
我们可以设置
![[Pasted image 20231217231601.png]]
这样我们就可以整个拒绝掉这个网段
把攻击最厉害的网段给拒绝掉

三剑客需要配合正则使用才是最大威力

产生攻击的对象，也就是这个ip，是可以找代理，但是代理也是需要花钱
攻击的ip往往不是真的而是一个代理ip
控制服务器就可以做肉鸡或者是网站劫持

