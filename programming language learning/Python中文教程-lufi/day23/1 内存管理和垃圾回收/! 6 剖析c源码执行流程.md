## 1 float类型

```c
typedef struct {
	PyObject_HEAD
	double ob_fval;
} PyFloatObject;
```

当我们写了python中
```python
val = 3.14
```

```c
// Objects/floatobject.c

// 用于缓存float对象的链表
static PyFloatObject * free_list = NULL;
static int numfree = 0;

PyObject *
PyFloat_FromDouble(double fval)
{
	// 如果free_list中有可能对象，则从free_list链表中拿出来一个，否则为对象重新开辟内存。
	PyFloatObject *op = free_list;
	if (op != NULL) {
		free_list = (PyFloatObject *) Py_TYPE(op);
		numfree--;
	} else {
		// 根据float类型的大小，为float对象开辟新的内存
		op = (PyFloatObject*) PyObject_MALLOC(sizeof(PyFloatObject));
		if (!op)
			return PyErr_NoMemory();
	}
	// 对float对象进行初始化，例如：引用计数器初始化为1，添加到refchain链表等
	/* Inline PyObject_New */
	(void)PyObject_INIT(op, &PyFloat_Type);

	// 对float对象赋值，即：op->ob_fval = 3.14
	op -> ob_fval = fval;
	return (PyObject *)op;
}
```
从上往下看，首先如果free_list中没有对象，重新开辟内存，就先测量结构体的大小，然后使用MALLOC创建一块新的内存
然后对其进行初始化添加到refchain

接下来看初始化的内容
```c
// Include/objimpl.h

#define PyObject_INIT(op, typeob) \
	(Py_TYPE(op) = (typeobj), _Py_NewReference((PyObject *)(op)), (op))
```
这里面进行了宏定义，然后执行了_Py_NewReference

然后看_Py_NewReference

## TO DO
c语言理解起来比较复杂，这个流程听一次但是不懂，需要知道c语言语法之后才能进行